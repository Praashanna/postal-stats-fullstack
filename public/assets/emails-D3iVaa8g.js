import{l as P,q as B,r as j,v as T,w as L,j as e,S as o,L as N}from"./index-bOg5e1e7.js";import{E as k}from"./error-state-Clm4qvnx.js";import{B as p,C as D,a as M,b as I,c as z,d as A}from"./card-D_x7gIuc.js";import{S as H,a as R,b as V,c as U,d}from"./select-CCRde_uN.js";import{I as q}from"./input-BvQnvjg1.js";import{B as $,T as F,a as O,b as w,c as m,d as W,e as x}from"./badge-D3VItwhe.js";import{P as Y,a as G,b as v,c as J,d as K,e as Q,f as X}from"./pagination-DCkCPeEW.js";import{c as Z}from"./createLucideIcon-D0HCzro4.js";import{M as _}from"./mail-C9Dw5UVI.js";import{U as ee,A as se}from"./users-B8a58puQ.js";import"./circle-x-D4EhXaT5.js";import"./index-GDyHvPTc.js";import"./index-BQWGh_0_.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=Z("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);function ie(t,r,h=2){const n=[],i=[];if(r<=7){for(let l=1;l<=r;l++)n.push(l);return n}const c=Math.max(2,t-h),u=Math.min(r-1,t+h);i.push(1),c>2&&i.push("...");for(let l=c;l<=u;l++)i.push(l);return u<r-1&&i.push("..."),r>1&&i.push(r),i}function fe(){const{serverId:t}=P(),{period:r,setPeriod:h}=B(),[n,i]=j.useState(1),[c,u]=j.useState(""),[l,S]=j.useState("");j.useEffect(()=>{const s=setTimeout(()=>{S(c),i(1)},300);return()=>clearTimeout(s)},[c]);const{data:a,isLoading:C,error:y}=T(t||"",r,n,50,l),f=L(),b=async()=>{if(t)try{await f.mutateAsync({serverId:t,period:r})}catch(s){console.error("Export failed:",s)}};if(!t)return e.jsx("div",{className:"p-6",children:"Please select a server from the sidebar."});if(C&&!a)return e.jsxs("div",{className:"w-full p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"h-8 w-64"}),e.jsx(o,{className:"h-10 w-32"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{className:"h-10 w-32"}),e.jsx(o,{className:"h-10 w-32"}),e.jsx(o,{className:"h-10 w-32"})]}),e.jsx(o,{className:"h-96 w-full"})]});if(y)return e.jsx(k,{error:y,message:"Failed to load emails data",type:"mail"});const E=a?ie(n,a.totalPages):[];return e.jsxs("div",{className:"w-full p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Bounced Emails"}),a&&e.jsxs($,{variant:"secondary",children:[a.total.toLocaleString()," emails"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{placeholder:"Search emails...",value:c,onChange:s=>u(s.target.value),className:"w-[200px]"}),e.jsxs(H,{value:r,onValueChange:h,children:[e.jsx(R,{className:"w-[180px]",children:e.jsx(V,{placeholder:"Select period"})}),e.jsxs(U,{children:[e.jsx(d,{value:"today",children:"Today"}),e.jsx(d,{value:"yesterday",children:"Yesterday"}),e.jsx(d,{value:"7d",children:"Last 7 days"}),e.jsx(d,{value:"14d",children:"Last 14 days"}),e.jsx(d,{value:"30d",children:"Last 30 days"})]})]}),e.jsxs(p,{onClick:b,disabled:f.isPending,size:"sm",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),f.isPending?"Exporting...":"Export CSV"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(N,{to:`/server/${t}/bounces`,children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Overview"]})}),e.jsx(p,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(N,{to:`/server/${t}/bounces/domain`,children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Bounced Domains"]})}),e.jsxs(p,{variant:"default",size:"sm",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Bounced Emails"]})]}),a&&e.jsxs(D,{children:[e.jsxs(M,{children:[e.jsx(I,{children:"Bounced Emails"}),e.jsxs(z,{children:["Showing ",a.data.length," of ",a.total," emails"]})]}),e.jsxs(A,{children:[e.jsxs(F,{children:[e.jsx(O,{children:e.jsxs(w,{children:[e.jsx(m,{children:"Email"}),e.jsx(m,{}),e.jsx(m,{children:"Domain"}),e.jsx(m,{children:"Last Bounce"}),e.jsx(m,{className:"text-right",children:"Bounces"})]})}),e.jsx(W,{children:a.data.map((s,g)=>e.jsxs(w,{children:[e.jsx(x,{className:"font-medium",children:s.email.split("@")[0]}),e.jsx(x,{children:"@"}),e.jsx(x,{children:s.domain}),e.jsx(x,{children:new Date(s.bounceDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),e.jsx(x,{className:"text-right",children:s.bounceCount})]},g))})]}),a.totalPages>1&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(Y,{children:e.jsxs(G,{children:[e.jsx(v,{children:e.jsx(J,{onClick:()=>i(Math.max(1,n-1)),className:n===1?"pointer-events-none opacity-50":"cursor-pointer"})}),E.map((s,g)=>e.jsx(v,{children:s==="..."?e.jsx(K,{}):e.jsx(Q,{onClick:()=>i(Number(s)),isActive:n===s,className:"cursor-pointer",children:s})},g)),e.jsx(v,{children:e.jsx(X,{onClick:()=>i(Math.min(a.totalPages,n+1)),className:n===a.totalPages?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})]})]})}export{fe as BouncedEmailsPage};
