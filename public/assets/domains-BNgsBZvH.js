import{l as P,q as b,r as h,t as T,j as e,S as o,L as N}from"./index-bOg5e1e7.js";import{E as B}from"./error-state-Clm4qvnx.js";import{B as u,C as D,a as L,b as E,c as k,d as M}from"./card-D_x7gIuc.js";import{S as I,a as R,b as z,c as A,d}from"./select-CCRde_uN.js";import{I as H}from"./input-BvQnvjg1.js";import{B as F,T as U,a as V,b as S,c as p,d as $,e as f}from"./badge-D3VItwhe.js";import{P as q,a as O,b as g,c as W,d as Y,e as G,f as J}from"./pagination-DCkCPeEW.js";import{M as K}from"./mail-C9Dw5UVI.js";import{U as Q,A as X}from"./users-B8a58puQ.js";import"./circle-x-D4EhXaT5.js";import"./createLucideIcon-D0HCzro4.js";import"./index-GDyHvPTc.js";import"./index-BQWGh_0_.js";function Z(l,r,m=2){const t=[],i=[];if(r<=7){for(let n=1;n<=r;n++)t.push(n);return t}const c=Math.max(2,l-m),x=Math.min(r-1,l+m);i.push(1),c>2&&i.push("...");for(let n=c;n<=x;n++)i.push(n);return x<r-1&&i.push("..."),r>1&&i.push(r),i}function xe(){const{serverId:l}=P(),{period:r,setPeriod:m}=b(),[t,i]=h.useState(1),[c,x]=h.useState(""),[n,w]=h.useState("");h.useEffect(()=>{const a=setTimeout(()=>{w(c),i(1)},300);return()=>clearTimeout(a)},[c]);const{data:s,isLoading:y,error:v}=T(l||"",r,t,50,n);if(!l)return e.jsx("div",{className:"p-6",children:"Please select a server from the sidebar."});if(y&&!s)return e.jsxs("div",{className:"w-full p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{className:"h-8 w-64"}),e.jsx(o,{className:"h-10 w-32"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{className:"h-10 w-32"}),e.jsx(o,{className:"h-10 w-32"}),e.jsx(o,{className:"h-10 w-32"})]}),e.jsx(o,{className:"h-96 w-full"})]});if(v)return e.jsx(B,{error:v,message:"Failed to load domains data",type:"mail"});const C=s?Z(t,s.totalPages):[];return e.jsxs("div",{className:"w-full p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Bounced Domains"}),s&&e.jsxs(F,{variant:"secondary",children:[s.total.toLocaleString()," domains"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{placeholder:"Search domains...",value:c,onChange:a=>x(a.target.value),className:"w-[200px]"}),e.jsxs(I,{value:r,onValueChange:m,children:[e.jsx(R,{className:"w-[180px]",children:e.jsx(z,{placeholder:"Select period"})}),e.jsxs(A,{children:[e.jsx(d,{value:"today",children:"Today"}),e.jsx(d,{value:"yesterday",children:"Yesterday"}),e.jsx(d,{value:"7d",children:"Last 7 days"}),e.jsx(d,{value:"14d",children:"Last 14 days"}),e.jsx(d,{value:"30d",children:"Last 30 days"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(N,{to:`/server/${l}/bounces`,children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Overview"]})}),e.jsxs(u,{variant:"default",size:"sm",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Bounced Domains"]}),e.jsx(u,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs(N,{to:`/server/${l}/bounces/email`,children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Bounced Emails"]})})]}),s&&e.jsxs(D,{children:[e.jsxs(L,{children:[e.jsx(E,{children:"Bounced Domains"}),e.jsxs(k,{children:["Showing ",s.data.domains.length," of ",s.total," domains"]})]}),e.jsxs(M,{children:[e.jsxs(U,{children:[e.jsx(V,{children:e.jsxs(S,{children:[e.jsx(p,{children:"Domain"}),e.jsx(p,{className:"text-right",children:"Bounces"}),e.jsx(p,{className:"text-right",children:"Percentage"})]})}),e.jsx($,{children:s.data.domains.map((a,j)=>e.jsxs(S,{children:[e.jsx(f,{className:"font-medium",children:a.domain}),e.jsx(f,{className:"text-right",children:a.count.toLocaleString()}),e.jsxs(f,{className:"text-right",children:[(a.count/s.data.totalBounces*100).toFixed(2),"%"]})]},j))})]}),s.totalPages>1&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(q,{children:e.jsxs(O,{children:[e.jsx(g,{children:e.jsx(W,{onClick:()=>i(Math.max(1,t-1)),className:t===1?"pointer-events-none opacity-50":"cursor-pointer"})}),C.map((a,j)=>e.jsx(g,{children:a==="..."?e.jsx(Y,{}):e.jsx(G,{onClick:()=>i(Number(a)),isActive:t===a,className:"cursor-pointer",children:a})},j)),e.jsx(g,{children:e.jsx(J,{onClick:()=>i(Math.min(s.totalPages,t+1)),className:t===s.totalPages?"pointer-events-none opacity-50":"cursor-pointer"})})]})})})]})]})]})}export{xe as BouncedDomainsPage};
